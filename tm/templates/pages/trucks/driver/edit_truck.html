{% extends 'base.html' %}

{% block title %} | Profile {% endblock %}
{% block content %}
{% load static %}
<section id="home" class="welcome-hero" 
style="position: relative;
background:url({% static "/img/mantap.gif" %})no-repeat;
background-position: center;
background-size: cover;
z-index: 1;">
    {% comment %} <div class="welcome-hero-txt"> {% endcomment %}
    <br><br><br><br><br><br>
    <div class="container">
        <div class="container-fluid">
            <div class="row">
                <div class="d-flex justify-content-center align-items-center vh-100">
                <div class="col">
                <br><br id="register-box"><br>
                <div class="col-lg-12" >
                    <div class="card" style="background-color: #ffffff; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); border: 1px solid #ddd; border-radius: 10px;">
                        <div class="card-header text-center">
                            <div class="logo-2">
                                <a href="#">
                                    <img src="{% static 'img/logos/PWF.gif' %}" alt="logo" class="img-fluid">
                                </a>
                            </div>
                            <h3>Edit Truck</h3>
                        </div>
                        <div class="card-body" style="margin: 15px;"  >
                            <div class="row">
                            {% if messages %}
                                {% for message in messages %}
                                    <div class="text-danger">
                                        {{ message }}
                                    </div>
                                {% endfor %}
                            {% endif %}
                            <form action="{% url 'save_truck' %}" method="POST" enctype="multipart/form-data">
                                {% csrf_token %}
                                <div class="form-group form-box">
                                    <label for="truck_model" class="col-form-label">Truck Model</label>
                                    <input type="text" name="truck_model" class="form-control" value="{{ request.session.truck_model }}" required>
                                </div>
                                <div class="form-group form-box">
                                    <label for="license_plate" class="col-form-label">License Plate</label>
                                    <input type="text" name="license_plate" class="form-control" value="{{ request.session.license_plate }}" required>
                                </div>
                                <div class="form-group form-box">
                                    <label for="capacity" class="col-form-label">Capacity</label>
                                    <input type="number" name="capacity" class="form-control" value="{{ request.session.capacity }}" required>
                                </div>
                                <div class="form-group form-box">
                                    <label for="location" class="col-form-label">Location</label>
                                    <input type="text" name="location" class="form-control" value="{{ request.session.location }}" required>
                                </div>
                                <div class="form-group form-box">
                                    <label for="status" class="col-form-label">Status</label>
                                    <input type="text" name="status" class="form-control" value="{{ request.session.status }}" required>
                                </div>
                                <div class="form-group form-box">
                                    <label for="last_maintained" class="col-form-label">Last Maintained</label>
                                    <input type="date" name="last_maintained" class="form-control" value="{{ request.session.last_maintained }}" required>
                                </div>
                                <div class="form-group">
                                    <label for="front_view" style="display: block; margin-bottom: 10px;">Upload Front View</label>
                                    <input type="file" class="form-control-file" id="front_view" name="front_view" style="display: none;" accept="image/*" onchange="document.getElementById('front_view_preview').src = window.URL.createObjectURL(this.files[0])">
                                    <button type="button" class="btn btn-primary" onclick="document.getElementById('front_view').click();">Choose File</button>
                                    <img id="front_view_preview" src="{{ request.session.front_view }}" alt="Front View Preview" style=" max-width: 200px; max-height: 200px;"/>
                                </div>
                                <!-- Repeat the above block for side_view, back_view, top_view, overall_view -->
                                <div class="form-group form-box">
                                    <label for="truck_accepted" class="col-form-label">Truck Accepted</label>
                                    <input type="checkbox" name="truck_accepted" class="form-control" {% if request.session.truck_accepted %}checked{% endif %}>
                                </div>
                                <div class="form-group form-box">
                                    <label for="truck_available" class="col-form-label">Truck Available</label>
                                    <input type="checkbox" name="truck_available" class="form-control" {% if request.session.truck_available %}checked{% endif %}>
                                </div>
                                <div class="form-group mb-0 text-center">
                                    <button type="submit" class="btn btn-success custom-btn">Save</button>
                                </div>
                            </form>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </div>
    </div>
<br>
</section>
<style>
    .custom-btn {
        width: 150px;
        height: 50px;
        transition: transform .2s; /* Animation */
    }
    
    .custom-btn:hover {
        transform: scale(1.02); /* (150% zoom - Note: if the zoom is too large, it will go outside of the viewport) */
    }
    .horizontal-line {
        border-top: 1px solid #D3D3D3;
        width: 100%;
        margin: 20px 0;
    }
    
    </style>
    <script>
        function previewFile() {
            const preview = document.querySelector('#preview');
            const file = document.querySelector('#profile_picture').files[0];
            const reader = new FileReader();
        
            reader.addEventListener("load", function () {
                // convert image file to base64 string
                preview.src = reader.result;
            }, false);
        
            if (file) {
                reader.readAsDataURL(file);
            }
        }
        </script>
{% endblock %}